<%= form_with(model: @project, html: { multipart: true }, local: true) do |form| %>
  <div class="row">
    <div class="col"></div>
    <div class="col-md-10">
      <% if @project.errors.any? %>
        <div id="error_explanation">
          <h2><%= pluralize(@project.errors.count, "error") %> prohibited this project from being saved:</h2>

          <ul>
            <% @project.errors.each do |error| %>
              <li><%= error.full_message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>
    </div>
    <div class="col"></div>
  </div>
  <div class="row m-4">
    <div class="col"></div>
    <div class="col-md-10">
      <div class="card">
        <div class="card-body">
          <h2 class="card-title"><%= action_name.capitalize %> Project</h2>
          <div class="card-text">
            <div class="row">
              <div class="col">
                <!-- Title input -->
                <div class="form-outline">
                  <%= form.text_field :title, class: "form-control", required: true %>
                  <%= form.label :title, class: "form-label" %>
                </div>
              </div>
              <div class="col">
                <!-- URL input -->
                <div class="form-outline">
                  <%= form.number_field :price, class: "form-control", required: true %>
                  <%= form.label :price, "Price ($)", class: "form-label" %>
                </div>
              </div>
              <div class="col">
                <!-- URL input -->
                <div class="form-outline">
                  <%= form.text_field :location, class: "form-control", required: true %>
                  <%= form.label :location, "Location", class: "form-label" %>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <div class="form-outline">
                  <%= form.date_field :start_date, required: true, class: "form-control" %>
                  <%= form.label :start_date, class: "form-label" %>
                </div>
              </div>
              <div class="col">
                <div class="form-outline">
                  <%= form.date_field :end_date, required: true, class: "form-control" %>
                  <%= form.label :end_date, class: "form-label" %>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <!-- Tag List -->
                <div class="form-outline">
                  <%= form.text_field :tag_list, placeholder: "Tags (separated by spaces)", class: "form-control", required: true %>
                  <%= form.label :tag_list, "Tags (separated by spaces) ", class: "form-label" %>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col">
                <!-- Description -->
                <div class="form-outline">
                  <%= form.rich_text_area :description, class: "form-control customized-min-height", input_html: { rows: "10" }, required: true %>
                  <%= form.label :description, class: "form-label" %>
                </div>
              </div>
            </div>

            <div class="row mb-2 p-2">
              <div class="col">
                <% if @project.images.attached? %>
                  <% @project.images.each do |image| %>
                    <%= link_to delete_upload_project_url(@project, image.id), method: :delete, data: { confirm: 'Are you sure you want to delete this image?' }, class:"delete_image" do %>
                      <i class="fa fa-times">
                        <%= image_tag image.variant(resize_to_limit: [200, 200]), class: "mb-2" %>
                      </i>
                    <% end %>
                  <% end %>
                <% end %>
              </div>
            </div>
            <div class="row">
              <div class="col">
                <%= form.file_field :images, multiple: true, direct_upload: true, class: "form-control job-images" %>
                <%= form.label :images, class: "form-label" %>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col">
                <output id="list"></output>
              </div>
            </div>

          </div>

          <div class="row">
            <div class="col">
              <%#= render 'payment' %>
            </div>
          </div>

          <div class="row mb-2">
            <div class="col">
              <%= form.submit "Save Project", class: "btn btn-primary save-btn-jobs" %>
            </div>
          </div>


          <div class="row mb-2">
            <div class="col">
              <div class="back-btn-jobs p-2 text-center">
                <%= link_to 'Back', projects_path, class: "btn-link back-btn-jobs" %>
              </div>
            </div>
            <% if (action_name == 'edit') %>
              <% if (current_user.id == @project.user_id) || (current_user.is_admin) %>
                <div class="col">
                  <div class="delete-btn-jobs p-2 text-center">
                    <%= link_to 'Delete', project_path(@project), :confirm => "Are you sure?", :method => :delete, class: "btn-link delete-btn-jobs" %>
                  </div>
                </div>
              <% end %>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="col"></div>
  </div>
<% end %>
